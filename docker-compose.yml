services:
    mediamtx:
        image: bluenviron/mediamtx
        ports:
            - "1935:1935"
            - "1936:1936"
            - "8888:8888"
            - "9997:9997"
        volumes:
            - "${PWD}/mediamtx.yml:/mediamtx.yml:ro"
            - "${PWD}/server.key:/server.key:ro"
            - "${PWD}/server.crt:/server.crt:ro"
        network_mode: host
    flask-video-app:
        environment:
          API_HOST: ${API_HOST}
          LIVE_HOST: ${LIVE_HOST}
        build: .
        command: ./boot.sh
        ports:
            - "5000:5000"
    nginx:
        image: nginx:alpine
        ports:
            - "8088:8088"
        depends_on:
            - web-app
        volumes:
            - ./default.conf:/etc/nginx/conf.d/default.conf